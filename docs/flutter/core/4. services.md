# services -- 平台服务与通道

提供与底层平台（Android/iOS/Windows/macOS/Linux/Web）通信的机制，以及系统服务访问。

### 1.1 核心能力

- 平台通道（MethodChannel、EventChannel、BasicMessageChannel、OptionalMethodChannel）
- 编解码器（StandardMethodCodec、StandardMessageCodec、JSONMethodCodec、JSONMessageCodec）
- 系统界面控制（SystemChrome、SystemUiOverlayStyle、SystemUiMode）
- 剪贴板（Clipboard、ClipboardData）
- 文本输入（TextInput、TextInputConnection、TextEditingValue、TextEditingController）
- 硬件按键（HardwareKeyboard、KeyEvent、PhysicalKeyboardKey、LogicalKeyboardKey）
- 系统声音（SystemSoundType、SystemSound）
- 设备方向（DeviceOrientation）
- 应用生命周期与窗口管理（AppLifecycleState、SystemChannels）
- 字体加载（FontLoader）

### 1.2 库结构

```dart
flutter/services
│
├── 平台通道通信
│   ├── MethodChannel             # 方法通道 (异步调用平台方法)
│   ├── OptionalMethodChannel     # 可选方法通道 (忽略 MissingPluginException)
│   ├── EventChannel              # 事件通道 (平台向 Dart 流式数据)
│   ├── BasicMessageChannel<T>    # 基础消息通道 (双向原始数据)
│   ├── MessageCodec<T>           # 消息编解码器接口
│   ├── MethodCodec               # 方法编解码器接口
│   ├── StandardMessageCodec      # 标准消息编解码器
│   ├── StandardMethodCodec       # 标准方法编解码器
│   ├── JSONMessageCodec          # JSON 消息编解码器
│   ├── JSONMethodCodec           # JSON 方法编解码器
│   ├── StringCodec               # 字符串编解码器
│   ├── BinaryCodec               # 二进制编解码器
│   ├── PlatformException         # 平台调用异常
│   ├── MissingPluginException    # 插件未实现异常
│   ├── PlatformChannel           # 平台通道基类
│   └── SystemChannels            # 预定义系统通道集合
│
├── 文本输入系统
│   ├── TextInput                 # 文本输入控制 (静态方法)
│   ├── TextInputConnection       # 文本输入连接
│   ├── TextInputClient           # 文本输入客户端接口
│   ├── DeltaTextInputClient      # 增量文本输入客户端
│   ├── TextEditingValue          # 文本编辑值 (文本/选择/composing)
│   ├── TextEditingDelta          # 文本编辑增量 (插入/替换/删除)
│   ├── TextEditingDeltaInsertion   # 插入增量
│   ├── TextEditingDeltaReplacement # 替换增量
│   ├── TextEditingDeltaDeletion    # 删除增量
│   ├── TextInputType             # 键盘类型枚举
│   ├── TextInputAction           # 输入操作枚举
│   ├── TextCapitalization        # 自动大写策略
│   ├── TextSelection             # 文本选择范围
│   ├── TextAffinity              # 文本亲和性 (upstream/downstream)
│   ├── SmartQuotesType           # 智能引号类型
│   ├── SmartDashesType           # 智能破折号类型
│   ├── AutofillConfiguration     # 自动填充配置
│   ├── AutofillHints             # 自动填充提示常量
│   ├── TextInputConfiguration    # 文本输入完整配置
│   ├── SelectionRect             # 选择矩形 (用于放大镜)
│   └── ScribbleClient            # 手写输入客户端 (iPad)
│
├── 剪贴板
│   ├── Clipboard                 # 剪贴板访问 (静态方法)
│   ├── ClipboardData             # 剪贴板数据 (text/html/image)
│   └── ClipboardStatusNotifier   # 剪贴板状态通知器
│
├── 系统界面控制
│   ├── SystemChrome              # 系统 Chrome 控制 (静态方法)
│   ├── SystemUiOverlayStyle      # 状态栏/导航栏样式
│   ├── SystemUiMode              # 系统 UI 模式 (immersive/edgeToEdge)
│   ├── SystemUiOverlay           # 系统 UI 覆盖层枚举 (top/bottom)
│   ├── setEnabledSystemUIMode()  # 设置 UI 模式
│   ├── setEnabledSystemUIOverlays()  # 已弃用
│   ├── setSystemUIOverlayStyle() # 设置 UI 样式
│   ├── restoreSystemUIOverlays() # 恢复 UI 覆盖层
│   └── setPreferredOrientations()  # 设置屏幕方向
│
├── 键盘与输入
│   ├── HardwareKeyboard          # 硬件键盘实例
│   ├── KeyEvent                  # 键盘事件基类
│   ├── KeyDownEvent              # 按键按下事件
│   ├── KeyUpEvent                # 按键抬起事件
│   ├── KeyRepeatEvent            # 按键重复事件
│   ├── PhysicalKeyboardKey       # 物理键码 (USB HID)
│   ├── LogicalKeyboardKey        # 逻辑键码 (字符含义)
│   ├── KeyEventManager           # 键盘事件管理器
│   ├── KeyMessageHandler         # 键消息处理器
│   ├── CharacterActivator        # 字符激活器 (快捷键)
│   ├── ShortcutActivator         # 快捷键激活器接口
│   ├── SingleActivator           # 单键激活器
│   └── RawKeyboard               # 原始键盘 (已弃用)
│
├── 系统声音与反馈
│   ├── SystemSound               # 系统声音 (静态方法)
│   ├── SystemSoundType           # 声音类型枚举 (click/alert)
│   ├── HapticFeedback            # 触觉反馈 (静态方法)
│   ├── HapticFeedbackType        # 触觉类型枚举
│   └── SystemNavigator           # 系统导航 (退出应用等)
│
├── 设备方向与平台
│   ├── DeviceOrientation         # 设备方向枚举
│   ├── ApplicationSwitcherDescription  # 应用切换器描述
│   └── setApplicationSwitcherDescription()  # 设置切换器描述
│
├── 字体加载
│   ├── FontLoader                # 字体加载器
│   ├── loadFontFromList()        # 从字节列表加载字体
│   └── loadFontFromUrl()         # 从 URL 加载字体
│
├── 窗口与视图
│   ├── SystemGestureEdge         # 系统手势边缘枚举
│   ├── AppExitResponse           # 应用退出响应
│   ├── AppExitType               # 应用退出类型
│   ├── SystemContextMenu         # 系统上下文菜单
│   └── SystemContextMenuItem     # 系统菜单项
│
└── 辅助功能
    ├── AccessibilityFeatures     # 辅助功能特性标志
    ├── AccessibilityFeature      # 辅助功能特性枚举
    └── AccessibilityBridge       # 辅助功能桥接 (内部)
```



---

