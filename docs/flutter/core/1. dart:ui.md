# dart:ui -- UI核心引擎绑定

Flutter 框架与底层 C++ 引擎交互的桥梁，暴露最低级的图形、文本和输入子系统，会自动导入每个 Flutter 程序中，无需显式使用 `import` 语句。

### 1.1 核心能力

- 图形绘制（Canvas、Picture、Scene、Path、Paint）
- 图像处理（Image、Codec、FrameInfo、PictureRecorder）
- 文本布局（Paragraph、ParagraphBuilder、TextStyle、StrutStyle）
- 输入事件（PointerEvent、KeyEvent、GestureSettings）
- 视图管理（FlutterView、Display、PlatformDispatcher、SingletonFlutterWindow）
- 着色器与滤镜（FragmentShader、Gradient、ColorFilter、ImageFilter、MaskFilter）
- 动画帧调度（FrameData、FrameTiming、AppLifecycleState）

### 1.2 库结构

```dart
dart:ui
│
├── 图形绘制核心
│   ├── Canvas                    # 画布，绘制操作接口
│   ├── Picture                   # 录制好的绘制指令
│   ├── PictureRecorder           # 绘制指令录制器
│   ├── Scene                     # 渲染场景
│   ├── SceneBuilder              # 场景构建器
│   ├── EngineLayer               # 引擎层句柄
│   ├── Path                      # 路径
│   ├── PathMetric                # 路径测量
│   ├── PathMetrics               # 路径测量集合
│   ├── Paint                     # 绘制配置 (颜色/粗细/混合模式)
│   ├── BlendMode                 # 混合模式枚举
│   ├── ClipOp                    # 裁剪操作枚举
│   ├── ClipBehavior              # 裁剪行为枚举
│   ├── VertexMode                # 顶点绘制模式
│   ├── Vertices                  # 顶点集合
│   ├── Tangent                   # 路径切线
│   └── PathOperation             # 路径布尔操作
│
├── 形状与变换
│   ├── RRect                     # 圆角矩形
│   ├── RSTransform               # 旋转缩放变换
│   ├── Radius                    # 圆角半径
│   ├── TextBox                   # 文本框几何
│   ├── BoxHeightStyle            # 文本框高度选择样式
│   ├── BoxWidthStyle             # 文本框宽度选择样式
│   └── PlaceholderAlignment      # 占位符对齐方式
│
├── 图像处理
│   ├── Image                     # 位图图像
│   ├── Codec                     # 图像编解码器
│   ├── FrameInfo                 # 动画帧信息
│   ├── ImageDescriptor           # 图像描述 (宽/高/颜色空间)
│   ├── ImageFilter               # 图像滤镜
│   ├── ColorFilter               # 颜色滤镜
│   ├── MaskFilter                # 遮罩滤镜 (模糊)
│   ├── ImageShader               # 图像着色器
│   ├── ImmutableBuffer           # 不可变 GPU 缓冲区
│   ├── ImageByteFormat           # 图像字节格式枚举
│   ├── PixelFormat               # 像素格式枚举
│   └── TileMode                  # 着色器平铺模式
│
├── 着色器与绘制效果
│   ├── Shader                    # 着色器基类
│   ├── Gradient                  # 渐变着色器 (线性/径向/扫掠)
│   ├── FragmentProgram           # 片段着色器程序 (SPIR-V)
│   ├── FragmentShader            # 片段着色器实例
│   ├── GradientShader            # 渐变着色器别名
│   ├── ImageFilter.compose()     # 滤镜组合
│   └── ColorFilter.mode()        # 颜色滤镜模式
│
├── 文本系统
│   ├── Paragraph                 # 段落布局结果
│   ├── ParagraphBuilder          # 段落构建器
│   ├── ParagraphConstraints      # 段落约束 (最大宽度)
│   ├── ParagraphStyle            # 段落样式
│   ├── TextStyle                 # 文本样式
│   ├── StrutStyle                # 支柱样式 (行高统一)
│   ├── TextHeightBehavior        # 文本高度行为
│   ├── TextWidthBasis            # 文本宽度基准
│   ├── TextAlign                 # 文本对齐枚举
│   ├── TextDirection             # 文本方向枚举
│   ├── TextDecoration            # 文本装饰枚举
│   ├── TextDecorationStyle       # 装饰线样式
│   ├── TextLeadingDistribution   # 行距分布
│   ├── TextBaseline              # 文本基线
│   ├── FontFeature               # OpenType 字体特性
│   ├── FontVariation             # 可变字体轴
│   ├── FontWeight                # 字重枚举
│   ├── FontStyle                 # 字体样式枚举
│   ├── LineMetrics               # 行度量信息
│   ├── GlyphInfo                 # 字形信息 (Flutter 3.0+)
│   ├── Shadow                    # 文字阴影
│   ├── TextBox                   # 文本框 (移至几何分类)
│   └── SpellOutStringAttribute   # 拼读属性 (无障碍)
│
├── 几何与数学
│   ├── Offset                    # 二维偏移
│   ├── OffsetBase                # 偏移基类
│   ├── Size                      # 尺寸 (宽/高)
│   ├── Rect                      # 轴对齐矩形
│   ├── RRect                     # 圆角矩形 (移至形状分类)
│   ├── Radius                    # 圆角半径 (移至形状分类)
│   ├── Transform                 # 4x4 变换矩阵
│   ├── Matrix4                   # 4D 矩阵 (实际在 vector_math)
│   └── lerpDouble()              # 双精度插值
│
├── 输入事件系统
│   ├── PointerEvent              # 指针事件基类
│   ├── PointerData               # 原始指针数据
│   ├── PointerChange             # 指针变化类型
│   ├── PointerSignalKind         # 指针信号类型
│   ├── PointerDeviceKind         # 指针设备类型
│   ├── KeyEvent                  # 键盘事件 (Flutter 3.0+)
│   ├── KeyData                   # 原始键数据
│   ├── KeyDataTransitMode        # 键盘数据传输模式
│   ├── PhysicalKeyboardKey       # 物理键盘键
│   ├── LogicalKeyboardKey        # 逻辑键盘键
│   ├── GestureSettings           # 手势设置 (触摸 slop)
│   └── DisplayFeature            # 显示特性 (刘海/折叠)
│
├── 视图与显示
│   ├── FlutterView               # Flutter 视图
│   ├── SingletonFlutterWindow    # 单例窗口 (已弃用)
│   ├── Display                   # 显示器配置 (DPI/刷新率)
│   ├── ViewConstraints           # 视图约束
│   ├── ViewPadding               # 视图内边距 (安全区域)
│   ├── ViewConfiguration         # 视图配置
│   ├── PlatformViewRegistry      # 平台视图注册
│   └── AssetBundle               # 资源包 (图片/字体加载)
│
├── 平台调度与生命周期
│   ├── PlatformDispatcher          # 平台调度器 (消息循环)
│   ├── AccessibilityFeatures       # 无障碍特性标志
│   ├── AppLifecycleState           # 应用生命周期状态
│   ├── Brightness                  # 亮度模式 (light/dark)
│   ├── CallbackHandle              # 回调句柄 (跨 isolate)
│   ├── ChannelBuffers              # 平台通道缓冲区
│   ├── PlatformMessageResponseCallback  # 平台消息响应回调
│   ├── PlatformConfiguration       # 平台配置集合
│   └── Locale                      # 区域设置
│
├── 帧与性能
│   ├── FrameData                 # 当前帧数据 (vsync)
│   ├── FrameTiming               # 帧时间统计
│   ├── FramePhase                # 帧构建阶段
│   ├── TimingsCallback           # 帧时间回调
│   └── DartPluginRegistrant      # 插件注册入口
│
├── 异步与回调
│   ├── SynchronousFuture         # 同步 Future (立即完成)
│   ├── VoidCallback              # 无参数回调类型别名
│   ├── FrameCallback             # 帧回调类型别名
│   ├── PointerDataPacketCallback # 指针数据包回调
│   ├── KeyDataCallback           # 键数据回调
│   └── PlatformMessageCallback   # 平台消息回调
│
└── 内部与工具
    ├── hashValues()              # 多值哈希 (已弃用，用 Object.hash)
    ├── hashList()                # 列表哈希 (已弃用)
    ├── clampDouble()             # 双精度钳制
    ├── debugPrint()              # 调试打印
    └── debugPrintSynchronously() # 同步调试打印
```



---

